!function(){"use strict";var t=function(){this.page=0,this.canNavigate=!0,this.firstPage=1,this.replay="TRUE",this.keyboardEvents=!0,this.referenceDocument=document,this.currentElement=null,this.guideSrc=null,this.guideType=null,this.tipArrow=null,this.guide=[{title:"DEFAULT TITLE",content:"Lorem Ipsum is simply dummy text of the printing and typesetting industry."}],this.guideWindow=null};t.prototype={init:function(t={},e,i){this.replaySettings=t.replay||this.replaySettings,this.page=t.page||this.page,this.referenceDocument=i||this.referenceDocument,this.guideSrc=e,this.keyboardEvents=t.keyboardEvents||this.keyboardEvents,this.navigator.apply(this,[]),this.element.apply(this,[]),this.errorHandler.apply(this,[]),this.player.apply(this,[]),this.ui.apply(this,[]),this.operations.apply(this,[]),this.keyboard.apply(this,[]),this.initGuide=function(t){this.guideType=typeof t,t&&"object"==this.guideType?(this.guide=t,this.firstPage=this.getFirstPage(),this.page=this.firstPage,this.goto(this.guide[this.page].id)):t&&"string"==this.guideType?this.getguideFromPath(this.guideSrc):this.throwError({type:"invalid guid type ",msg:this.guideType}),this.keyboardEvents&&(this.referenceDocument.onkeydown=this.addKeyboardEvents)},this.getguideFromPath=function(t){var e=new XMLHttpRequest;e.onreadystatechange=function(){4==this.readyState&&200==this.status&&(GLSPlayer.guide=JSON.parse(e.responseText).steps,GLSPlayer.firstPage=GLSPlayer.getFirstPage(),GLSPlayer.page=GLSPlayer.firstPage,GLSPlayer.goto(this.guide[this.page].id))},e.open("GET",t,!0),e.send()}},navigator:function(){this.next=function(){this.canNavigate?this.goto(this.guide[this.page].next):this.throwError({type:"last-page",msg:"You are already reached Last page "+this.page})},this.previous=function(){this.page>this.firstPage?this.goto(this.guide[this.page].id-1):this.throwError({type:"first-page",msg:"You are already on page "+this.page})},this.goto=function(t=null){this.page=this.getIndexwitId(t),this.renderTip(),this.canNavigate=this.guide[this.page].next,this.manageButtons()},this.skip=function(){console.log("Next page skipped current page : ",this.page)},this.getFirstPage=function(){return this.getIndexwitId(this.getFirstId())}},player:function(){this.play=function(t=!1){t?(this.guideWindow=t,this.guideWindow.style.position="absolute",this.tipArrow=this.referenceDocument.querySelector(".gls-arrow"),this.nextButton=this.referenceDocument.querySelector(".gls-next"),this.previousButton=this.referenceDocument.querySelector(".gls-previous")):this.createGuideWindow(),this.initGuide(this.guideSrc)},this.stop=function(){this.reset(),this.hide()},this.replay=function(){this.reset(),this.play(this.guide)},this.reset=function(){this.page=this.firstPage}},element:function(){this.getElement=function(t){switch(this.reference=this.getReference(t),this.reference.type){case"ID":return this.byId(this.reference.identifier);case"CLASS":return this.byClass(this.reference.identifier);case"XPATH":return this.byXpath(this.reference.identifier);case"JQEQ":return this.reference.identifier=this.fromXpathFromJqueryEq(this.reference.identifier),this.byXpath(this.reference.identifier);default:this.throwError({type:"unsupported",msg:"Not supported reference "+t})}},this.byId=function(t){return this.currentElement=this.referenceDocument.querySelector(t)||this.throwError({type:"no-ref",msg:"no reference found with Id "+t}),this.currentElement},this.byClass=function(t){return this.currentElement=this.referenceDocument.querySelector(t)||this.throwError({type:"no-ref",msg:"no reference found with Class Name "+t}),this.currentElement},this.byXpath=function(t){return this.currentElement=this.referenceDocument.evaluate(t,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue||this.throwError({type:"no-ref",msg:"no reference found with Xpath "+t}),this.currentElement},this.groomTo=function(t){this.guideWindow.style.top=this.getElement(t).offsetTop+this.getElement(t).offsetHeight+4+"px",this.guideWindow.style.left=this.getElement(t).getBoundingClientRect().left+this.getElement(t).offsetWidth/2-this.guideWindow.offsetWidth/2+"px",this.guideWindow.offsetTop>=this.referenceDocument.body.parentElement.scrollHeight-this.guideWindow.offsetHeight?(this.guideWindow.style.top=this.referenceDocument.body.parentElement.scrollHeight-this.getElement(t).offsetHeight-2*this.guideWindow.offsetHeight-8+"px",this.tipArrow.style.bottom="-8px",this.tipArrow.style.borderBottom="unset",this.tipArrow.style.borderTop="8px solid rgba(0,0,0,0.2)"):(this.tipArrow.style.bottom="100%",this.tipArrow.style.borderTop="unset",this.tipArrow.style.borderBottom="8px solid rgba(0,0,0,0.2)")},this.getReference=function(t){return this.reference={identifier:t,type:t.includes(".")?"CLASS":t.includes("#")?"ID":t.includes("/")?"XPATH":t.includes(":")?"JQEQ":""},this.reference},this.manageButtons=function(){this.firstPage==this.page?this.previousButton.hide():this.previousButton.show(),this.canNavigate?this.nextButton.show():this.nextButton.hide()}},errorHandler:function(){this.throwError=function(t){console.log(t)}},ui:function(){this.markup=`\n\t\t\t\t<div id="guide">\n\t\t\t\t<div class="gls-arrow"></div>\n\t\t\t\t\t\t<div class="guide-close" onclick="GLSPlayer.hide()">X</div>\n\t\t\t\t\t<div class="guide-tip" id="gls-tip">\n\t\t\t\t\t\t${this.guide[this.page].content}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="button-wrap">\n\t\t\t\t\t\t<a class="button gls-previous" onclick="GLSPlayer.previous()">Previous</a>\n\t\t\t\t\t\t<a class="button gls-next" onclick="GLSPlayer.next()">Next</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`,this.css="#guide{\n\t\t\t\t\tbackground-color: rgba(0,0,0,0.2);\n\t\t\t\t\tborder-radius: 20px;\n\t\t\t\t\tpadding: 4px;\n\t\t\t\t}\n\t\t\t\t.guide-tip {\n\t\t\t\t\tpadding: 4px;\n\t\t\t\t\tfont-style: italic;\n\t\t\t\t\toverflow: auto;\n\t\t\t\t\tmargin-top: 8px;\n\t\t\t\t\ttext-align: center;\n\t\t\t\t\twidth: 100%;\n\t\t\t\t}\n\t\t\t\t.guide-close {\n\t\t\t\t\t\tfloat: right;\n\t\t\t\t\t\tmargin-right: 20px;\n\t\t\t\t\t\tcursor: pointer;\n\t\t\t\t}\n\t\t\t\t.button-wrap{\n\t\t\t\t\ttext-align: right;\n\t\t\t\t\tpadding: 2px;\n\t\t\t\t}\n\t\t\t\t.gls-arrow {\n\t\t\t\t\twidth: 0;\n\t\t\t\t\theight: 0;\n\t\t\t\t\tborder-left: 4px solid transparent;\n\t\t\t\t\tborder-right: 4px solid transparent;\n\t\t\t\t\tborder-bottom: 8px solid rgba(0,0,0,0.2);\n\t\t\t\t\tleft: 50%;\n\t\t\t\t\ttext-align: center;\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\tbottom: 100%;\n\t\t\t\t}\n\t\t\t\ta.button {\n\t\t\t\t\tmargin-right: 14px;\n\t\t\t\t\tcursor: pointer;\n\t\t\t\t}\n\t\t\t\ta.button:hover {\n\t\t\t\t\tcolor: #88c999;\n\t\t\t\t}",this.addStyle=function(){this.defaultStyle=this.referenceDocument.createElement("style"),this.defaultStyle.type="text/css",this.defaultStyle.styleSheet?this.defaultStyle.styleSheet.cssText=this.css:this.defaultStyle.appendChild(this.referenceDocument.createTextNode(this.css)),this.referenceDocument.getElementsByTagName("head")[0].appendChild(this.defaultStyle)},this.createGuideWindow=function(){this.addStyle(),this.guideWindow=this.referenceDocument.createElement("DIV"),this.guideWindow.style.position="absolute",this.guideWindow.innerHTML=this.markup,this.referenceDocument.body.appendChild(this.guideWindow),this.tipArrow=this.referenceDocument.querySelector(".gls-arrow"),this.nextButton=this.referenceDocument.querySelector(".gls-next"),this.previousButton=this.referenceDocument.querySelector(".gls-previous")},this.hide=function(){this.guideWindow.style.visibility="hidden"},this.show=function(){this.guideWindow.style.visibility="visible"},this.renderTip=function(){this.referenceDocument.getElementById("gls-tip").innerHTML=this.guide[this.page].content,this.groomTo(this.guide[this.page].selector)}},operations:function(){this.getSortedNumberIds=function(t){return t.sort(this.sortIds)},this.sortIds=function(t,e){return t-e},Array.prototype.getLastItem=function(){return this[this.length-1]},HTMLElement.prototype.hide=function(){this.style.visibility="hidden"},HTMLElement.prototype.show=function(){this.style.visibility="visible"},this.getFirstId=function(){return this.getSortedNumberIds(this.guide.map(function(t){return t.id}))[0]},this.getIndexwitId=function(t){for(var e=0;e<this.guide.length;e++){if(this.guide[e].id==t)return e;if(e==this.guide.length)return-1}},this.fromXpathFromJqueryEq=function(t){return t="//"+t.split(":")[0]+"["+(parseInt(t.match(/\d+/g).map(Number)[0])+1)+"]"},this.windowResize=function(){this.renderTip()}},keyboard:function(){this.addKeyboardEvents=function(t){switch(GLSPlayer.referenceDocument.all?t||((t=GLSPlayer.referenceDocument.window.event).which=t.keyCode):t.which&&(t=t),t.which){case 39:GLSPlayer.next();break;case 37:GLSPlayer.previous()}}}},window.GLSPlayer=new t}();